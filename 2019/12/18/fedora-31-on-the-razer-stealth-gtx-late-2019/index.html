<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Fedora 31 on the Razer Stealth GTX (Late 2019) :: N. Harrison Ripps</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="My hunt for a shiny new laptop always starts with the best of intentions, but well-intentioned laptops usually don’t come with gaming-ready GPUs. What do I mean by a “well-intentioned” laptop? I have a lot of respect for System76 and Star Labs for their lovely Linux-first systems, and particular respect for Purism‘s holistic approach to the union of open source hardware and privacy. But I’d be lying to myself if I didn’t admit that my ideal laptop is just as capable of running triple-A video games as it is of running Linux-based workloads." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/2019/12/18/fedora-31-on-the-razer-stealth-gtx-late-2019/" />




<link rel="stylesheet" href="/assets/style.css">

  <link rel="stylesheet" href="/assets/green.css">






<link rel="apple-touch-icon" href="/img/apple-touch-icon-192x192.png">

  <link rel="shortcut icon" href="/img/favicon/green.png">



<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="nhripps" />
  
    <meta name="twitter:creator" content="Harrison Ripps" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Fedora 31 on the Razer Stealth GTX (Late 2019)">
<meta property="og:description" content="My hunt for a shiny new laptop always starts with the best of intentions, but well-intentioned laptops usually don’t come with gaming-ready GPUs. What do I mean by a “well-intentioned” laptop? I have a lot of respect for System76 and Star Labs for their lovely Linux-first systems, and particular respect for Purism‘s holistic approach to the union of open source hardware and privacy. But I’d be lying to myself if I didn’t admit that my ideal laptop is just as capable of running triple-A video games as it is of running Linux-based workloads." />
<meta property="og:url" content="/2019/12/18/fedora-31-on-the-razer-stealth-gtx-late-2019/" />
<meta property="og:site_name" content="N. Harrison Ripps" />

  
    <meta property="og:image" content="/img/favicon/green.png">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

  <meta property="article:section" content="Uncategorized" />


  <meta property="article:published_time" content="2019-12-18 19:49:52 &#43;0000 &#43;0000" />












</head>
<body class="green">


<div class="container headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    N. Harrison Ripps
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/projects">Projects</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/projects">Projects</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="/2019/12/18/fedora-31-on-the-razer-stealth-gtx-late-2019/">Fedora 31 on the Razer Stealth GTX (Late 2019)</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2019-12-18 
      </span>
    
    
    <span class="post-author">:: Harrison Ripps</span>
    
  </div>

  

  

  

  <div class="post-content"><div>
        <p>My hunt for a shiny new laptop always starts with the best of intentions, but well-intentioned laptops usually don’t come with gaming-ready GPUs. What do I mean by a “well-intentioned” laptop? I have a lot of respect for <a href="https://system76.com/">System76</a> and <a href="https://starlabs.systems/">Star Labs</a> for their lovely Linux-first systems, and particular respect for <a href="https://puri.sm/">Purism</a>‘s holistic approach to the union of open source hardware and privacy. But I’d be lying to myself if I didn’t admit that my ideal laptop is just as capable of running triple-A video games as it is of running Linux-based workloads.</p>
<p>With this in mind, after careful consideration of several sensible options, I ended up with <a href="https://support.razer.com/gaming-laptops/razer-blade-stealth-13-late-2019-gtx-model/">Razer’s 13″ Stealth GTX</a> laptop. As far as I can tell, this is the first time that Razer has offered a discrete GPU in their 13″ Stealth form factor. The result is a completely-under-the-radar ultraportable gamer that doesn’t look out of place on the desk in my office.</p>
<p>In order for me to make the best use of my laptop as a work system, Windows 10 wasn’t going to cut it. Even with the Windows Subsystem for Linux in place, native Linux Containers don’t work in a Windows 10 environment. Not to mention the odd looks I’d be getting from a company full of folks that, for the most part, stick with RHEL, Fedora, and MacOS.</p>
<p>So, here’s a walkthrough of everything I did to get a dual-booted Linux environment running on this beast of an ultrabook:</p>
<h3 id="1-set-up-windows">1. Set up Windows<a href="#1-set-up-windows" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Out of the box, set up the Windows environment on the Razer. This includes all of the updates of Windows, Razer drivers, the nVidia driver, etc. It will probably take a couple of hours to get through this step.</p>
<h3 id="2-create-space-for-linux">2. Create Space for Linux<a href="#2-create-space-for-linux" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Using the built-in Windows Disk Management utilities, shrink the largest single partition on your hard drive. Personally I wanted about 120GB for my Linux setup out of the total 512GB of space on the drive. The largest partition was like 450GB, and now it’s down to 330ish. Plenty of space for video games.</p>
<h3 id="3-disable-secureboot">3. Disable SecureBoot<a href="#3-disable-secureboot" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>For the approach I’m going to use to install nVidia drivers, I needed to disable SecureBoot in the BIOS. There is a workaround if you want to go through the trouble of self-signing the nVidia drivers — Google will point you in the right direction.</p>
<h3 id="4-install-linux">4. Install Linux<a href="#4-install-linux" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>As the title of this article implies, I installed Fedora 31 from a LiveUSB image onto the laptop. A couple of notes here:</p>
<ul>
<li>I let the installer auto-partition the empty space on the laptop drive</li>
<li>I encrypted the Linux installation because it’s good form</li>
</ul>
<p>Left to it’s own devices, the LiveUSB installer detected the Windows partition and automatically included support for booting into Windows from the grub2 boot menu.</p>
<h3 id="5-hardware-compatibility-adjustments">5. Hardware Compatibility Adjustments<a href="#5-hardware-compatibility-adjustments" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Once the installation was done and I could boot into Linux, I spent a few days of trial and error trying to figure out the right adjustments for the Razer Stealth hardware. Here’s what I found:</p>
<p><strong>Suspend / wake fixes</strong><br>
This was the main, non-intuitive problem I ran into. Everything seemed cool with the Linux installation until I closed the laptop lid for the first time. When I opened it later, the laptop seemed to un-suspend but then a moment later it was trying to suspend again.</p>
<p>Later on, upgrading to Linux 5.4.7 exposed a problem with the nVidia driver (more on the nVidia driver below), but props to Major Hayden for finding a solution for that.</p>
<p>The fixes to both of these issues involve passing arguments to the kernel command line. As root, edit <code>/etc/default/grub</code> and find the line that starts with <code>GRUB_CMDLINE_LINUX</code>. To the end of the line of arguments assigned here, add <code>button.lid_init_state=open pcie_port_pm=off</code>.</p>
<p>After doing this, still as root, run <code>grub2-mkconfig -o /boot/efi/EFI/fedora/grub.cfg</code> to force the regeneration of the grub config menus.</p>
<p><strong>Replace Nouveau with nVidia drivers</strong><br>
Following <a href="https://major.io/2019/12/12/thinkpad-t490-fedora-install-tips/">the wisdom of Major Hayden</a>, I enabled the RPMFusion yum repos and installed the <code>akmod-nvidia</code> drivers. This approach is really slick as it not only installs functional drivers, but it also does the blacklisting of the nouveau drivers for you.</p>
<p><strong>Control that fancy keyboard</strong><br>
As of the time of this post, there is a <a href="https://github.com/openrazer/openrazer/pull/962">pull request</a> making its way through the <a href="https://openrazer.github.io/">OpenRazer</a> project’s code review process that will enable support for this laptop model. I’ve already set up the <a href="https://openrazer.github.io/#download">Fedora repo</a> and installed the <code>openrazer-meta</code> package. When that PR is merged and the RPM is rebuilt, I’ll be able to tell my keyboard to pick a color and stick with it.</p>
<h3 id="and-there-you-have-it">And there you have it<a href="#and-there-you-have-it" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Even though the steps ended up being pretty straightforward, a <em>lot</em> of trial and error went into getting this all figured out. Hopefully this will be useful to the next person who decides to go large with a Razer Stealth GTX while going Linux at the same time!</p>

      </div></div>

  
  
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        
        <span class="button next">
            <a href="/2019/11/12/2019-year-of-the-spartan/">
                <span class="button__text">2019: Year of the Spartan</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">
        <span>All content copyright &#169; 2014-2020, N. Harrison Ripps except where noted.</span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>







  
</div>

</body>
</html>
